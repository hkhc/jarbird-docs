---
layout: default.njk
eleventyNavigation:
  key: reference
  title: Reference
  order: 3
title: Reference
tags: main
---

# title

## Reference

To publish it to public repository like Maven Central, we need to provide more information in the form of [POM XML](https://maven.apache.org/pom.html). Traditionally we provide this POM information in hand-coded publishing section. However to make things more complicated, when we publish our artefacts to multiple repositories, like Maven Central, jCenter, and Gradle plugin portal, we need to specify the same piece of information multiple times at different plugin configurations. The published POM XML is generated by these plugins. This creates a significant amount of boilerplate code in the build script. Jarbird is aimed to simplify this process by having a single place to specify POM information.

Jarbird read POM information from a file called pom.yml. It is YAML format means to be human friendly to specify POM details.

The plugin read pom.yml at several places. The plugin read pom.yml at the following order:

- `$GRADLE_USER_HOME/pom.yml`

- `[project-root-dir]/pom.yml`

- `[sub-project-dir]/pom.yml`

- file specified by `pomFile` system property. 

The rule of thumb is that the files will be sitting side-by-side with gradle.properties. By putting some of the information out of the project directory, some common information can be shared among projects, like developer information.

The content of later files overwrites the content of the preceding files. The content of the files will be used to generate the configuration of maven publication, bintray publication, and gradle plugin portal.

### Format of pom.yml

Most of the content within pom.yml could be optional. However, it takesa full pom.yml file to satisfy Maven Central requirement.

This is the pom.yml from the Jarbird source code. Yes, it makes use of itself to build and publish artifact.

:::code-group
```yaml
# group name of the artifact, use project.group if omitted
group: io.hkhc.gradle
artifactId: jarbird
name: Jarbird
version: 0.3.3.2
description: Wrapping boilerplate code of publishing artefact to maven repository
packaging: jar

licenses:
- name: Apache-2.0

developers:
- id: hkhc
  name: Herman Cheung
  email: herman.kh.cheung+jarbird@gmail.com

scm:
  repoType: github.com
  repoName: hkhc/jarbird

plugin:
  id: io.hkhc.jarbird
  displayName: Jarbird
  implementationClass: io.hkhc.gradle.JarbirdPlugin
  tags:
  - publish
```
:::

### Coordinate

The combination `group:artifactId:version` is known as the "coordinate" of the artefact. if pom.yml is not provided, the `project.group`, `project.name` and `project.version` is used to form the coordinate.

Otherwise, the `group`, `artifactId`, `version` in pom.yml will be used.

If both values in the build script and pom.yml exist, the value at pom.xml has precedence. 

When publishing to Maven Central, make sure the group name has been properly [verified](https://central.sonatype.org/pages/producers.html#individual-projects-open-source-software-repository-hosting-ossrh).

### Artifact name

`name`  field is a descriptive name of the artefact. If it is not specified, `group:artifactId` will be used as the name.

### License

We can specify multiple licenses for the artefact. Most of the time we need only one. In its simplest form, we may just specify the `name` field under `licenses`. For example

:::code-group
```yaml
licenses:
- name: Apache-2.0
```
:::

 Then URL is automatically provided for configure publishing plugins. Optionally we may provide more information:

:::code-group
```yaml
licenses:
- name: Apache-2.0
  url: http://www.apache.org/licenses/LICENSE-2.0.txt
  dist: repo
  comments: This is an example of license block
```
:::

Right now only the following license names are automatically expanded:

- `Apache-2.0`

- `BSD-3-Clause`

- `MIT`

- `GPLv3`

- `LGPLv3`

When merging license information from multiple pom.yml, the following rules apply:

- License information of different name is treated as separate licenses in merged information.

- License information at pom.xml of higher precedence overwrites the license of the same name in the file of lower precedence, in field by field basis.

### Developers and Contributors

We can specify multiple developers and contributors in pom.yml. Both of them share the same structure. Minimally, one developer entry should be provided which contains `name`, `email`.  In full, it accepts the following fields:

:::code-group
```yaml
developers:
- id: <id>
  name: <your name>
  email: <your email>
  organization: <your organization>
  organizationUrl: <url of your organization>
  timezone: <time zone of your place>
```
:::

### Source Control information

We need to provide quite a bit of information for your source code repository. Simple publisher provide a shorthand representation to simply the process:

:::code-group
```yaml
Scm:
  repoType: <the hostname of the repo>
  repoName: <the name of your repo>
```
:::

This will expand to fields in POM XML. For example,

:::code-group
```yaml
Scm:
  repoType: github.com
  repoName: myname/myrepo
```
:::

will expand to:

| field               | value                                     |
| ------------------- | ----------------------------------------- |
| url                 | `https://github.com/myname/myrepo`        |
| connection          | `scm:git@github.com/myname/myrepo`        |
| developerConnection | `scm:git@github.com/myname/myrepo.git`    |
| issueType           | `github.com`                              |
| issueUrl            | `https://github.com/myname/myrepo/issues` |

If `repoType` or `repoName` are not specified, no automatic generation is done.  One may manually fill in the information at pom.yml. 

### Web

We may specify the detail of Web section in pom.yml:

:::code-group
```yaml
web:
  url: https://myproject.org
  description: This is my library project.
```
:::

If they are omitted, the `url` field is replaced by the value of `scm.url`, and the description field is replaced by the description of the artifact.

### Url

The project has its url field. If it is omitted, the Scm.url field is used. 

## Minimal requirement of POM for Maven Central

While the information in pom.yml is mostly optional, we need them all such that Maven Central repository accepts our submission.

## Publishing Gradle Plugin

Jarbird can also help build and publish Gradle plugin to Gradle Plugin Portal and other repositories. We need some more information about the plugin. Add the following section to pom.xml

:::code-group
```yaml
plugin:
  id: <your "new style" plugin ID>
  displayName: <Descriptive name of the plugin>
  implementationClass: <Implementation class of the plugin>
  tags: 
    - <tags to be shown in Gradle Plugin Portal page>
```
:::

Then add the following to Gradle script:

:::code-group
```kts
simplyPublish {
    gradlePlugin = true
}
```
:::

Of course, we still need the Gradle Plugin Portal account setting in `gradle.properties`, which is be available at your profile page at Gradle Plugin Portal. 

:::code-group
```properties
gradle.publish.key=API Key
gradle.publish.secret=API Secret
```
:::

When all of these are presents, the plugin adds a task `jbPublishToGradlePortal`  that you can publish the plugin to Gradle Portal.

Gradle find the location of the local repository in the following order:

- System property `maven.repo.local`

- The `<localRepository>` maven [setting](http://maven.apache.org/settings.html#Settings_Details)
  
  - at `$M2_HOME/conf/setting.xml` where `M2_HOME` is an environment variable. 
  
  - at `~/.m2/conf/settings.xml`

- If all of above are not found, the default is `~/.m2/repository`
